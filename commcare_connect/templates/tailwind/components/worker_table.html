{% extends "tailwind/base_table.html" %}

{% block table_wrapper %}
<div x-data="{
    selectedRows: [],
    toggleRow(id) {
        const index = this.selectedRows.indexOf(id);
        if (index === -1) {
            this.selectedRows.push(id);
        } else {
            this.selectedRows.splice(index, 1);
        }
        this.$dispatch('selection-changed', {
            selected: this.selectedRows
        });
    },
    toggleAll() {
        const checkboxes = this.$el.querySelectorAll('input[type=checkbox]');
        const allSelected = this.selectedRows.length === checkboxes.length;
        
        if (allSelected) {
            this.selectedRows = [];
        } else {
            this.selectedRows = Array.from(checkboxes).map(cb => parseInt(cb.dataset.id));
        }
        
        this.$dispatch('selection-changed', {
            selected: this.selectedRows
        });
    },
    isSelected(id) {
        return this.selectedRows.includes(id);
    }
}">
    {{ block.super }}
</div>
{% endblock %}